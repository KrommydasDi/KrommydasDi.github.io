<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home — Dimitrios Krommydas</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Small, text-wrapped YouTube embed */
    .video-inline {
      float: right;
      width: 240px;              /* adjust to taste (e.g., 200–300px) */
      aspect-ratio: 16/9;
      margin: 0 0 1rem 1rem;     /* space from the text */
    }
    .video-inline > div,
    .video-inline iframe {
      width: 100%;
      height: 100%;
      display: block;
      border: 0;
    }
    /* Make the inline video stack nicely on phones */
    @media (max-width: 600px) {
      .video-inline { float: none; width: 100%; margin: 1rem 0; }
    }
    /* Ensure local <video> scales responsively */
    video { max-width: 100%; height: auto; display: block; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="header-flex">
        <div>
          <h1>Dimitrios Krommydas</h1>
          <p class="subtitle">NWO Rubicon Grant Recipient & Postdoctoral Researcher - UCSB</p>
        </div>
        <div>
          <img src="Dimitris.jpeg" alt="Dimitrios Krommydas">
        </div>
      </div>
    </div>
  </header>

  <nav>
    <div class="wrap">
      <a href="index.html">Home</a>
      <a href="cv.html">CV</a>
      <a href="publications.html">Publications</a>
      <a href="awards.html">Awards</a>
    </div>
  </nav>

  <main class="wrap">
    <section id="home">
      <h2>Home</h2>

      <!-- Small, text-wrapped YouTube embed (autoplay + smooth loop via IFrame API) -->
      <figure class="video-inline" aria-label="Low-resolution clip (auto-plays and loops)">
        <div id="yt-inline"></div>
      </figure>

      <p class="muted">
        Employing continuum field theories, such as hydrodynamics, I study the emergence and functionality of order
        in biological and bio-inspired systems. Below is a short clip from my work. Use the top bar to navigate to my
        CV, publications, and awards.
      </p>

      <!-- Embedded MP4 from your repo — autoplay, muted (required for autoplay), loop -->
      <div class="video" style="margin-top:16px;">
        <video autoplay muted loop playsinline controls preload="metadata">
          <source src="defect_quadrupole.mp4" type="video/mp4">
          Your browser does not support the video tag.
          <a href="defect_quadrupole.mp4">Download video</a>
        </video>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="wrap">
      © <span id="y"></span> Dimitrios Krommydas
    </div>
  </footer>

  <script>
    // Year stamp
    document.getElementById('y').textContent = new Date().getFullYear();

    // --- YouTube IFrame API for smoother looping autoplay ---
    // Load API
    (function loadYT() {
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      document.head.appendChild(tag);
    })();

    let ytPlayer;
    // API callback must be global
    function onYouTubeIframeAPIReady() {
      ytPlayer = new YT.Player('yt-inline', {
        videoId: 'bvBdAwXArkI',
        playerVars: {
          autoplay: 1,          // autoplay
          mute: 1,              // required by browsers to allow autoplay
          loop: 1,              // loop
          playlist: 'bvBdAwXArkI', // required for loop to work
          controls: 0,          // hide controls (cleaner + avoids clicks)
          modestbranding: 1,
          rel: 0,
          fs: 0,
          playsinline: 1,
          iv_load_policy: 3,
          cc_load_policy: 0
        },
        events: {
          onReady: function (e) { e.target.playVideo(); },
          onStateChange: function (e) {
            // If YouTube fires ENDED, immediately restart
            if (e.data === YT.PlayerState.ENDED) {
              e.target.seekTo(0.001, true);
              e.target.playVideo();
            }
          }
        }
      });
    }

    // Extra smoothing: preemptively seek just before the end to avoid the brief pause/flash
    const LOOP_SAFETY = 0.15; // seconds before the end to jump
    setInterval(() => {
      if (!ytPlayer || typeof ytPlayer.getCurrentTime !== 'function') return;
      const dur = ytPlayer.getDuration ? ytPlayer.getDuration() : 0;
      const t = ytPlayer.getCurrentTime ? ytPlayer.getCurrentTime() : 0;
      if (dur && t > 0 && (dur - t) < LOOP_SAFETY) {
        ytPlayer.seekTo(0.001, true);
      }
    }, 100);
  </script>
</body>
</html>
